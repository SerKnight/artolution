!function(){function e(e,t,o){var n;return n=e.getWrapperElement().appendChild(document.createElement("div")),n.className=o?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top",n.innerHTML=t,n}CodeMirror.defineExtension("openDialog",function(t,o,n){function r(){c||(c=!0,i.parentNode.removeChild(i))}var i=e(this,t,n&&n.bottom),c=!1,s=this,f=i.getElementsByTagName("input")[0];return f?(CodeMirror.on(f,"keydown",function(e){(13==e.keyCode||27==e.keyCode)&&(CodeMirror.e_stop(e),r(),s.focus(),13==e.keyCode&&o(f.value))}),n&&n.value&&(f.value=n.value),f.focus(),CodeMirror.on(f,"blur",r)):(t=i.getElementsByTagName("button")[0])&&(CodeMirror.on(t,"click",function(){r(),s.focus()}),t.focus(),CodeMirror.on(t,"blur",r)),r}),CodeMirror.defineExtension("openConfirm",function(t,o,n){function r(){s||(s=!0,c.parentNode.removeChild(c),f.focus())}var i,c=e(this,t,n&&n.bottom),t=c.getElementsByTagName("button"),s=!1,f=this,a=1;for(t[0].focus(),n=0;n<t.length;++n)i=t[n],function(e){CodeMirror.on(i,"click",function(t){CodeMirror.e_preventDefault(t),r(),e&&e(f)})}(o[n]),CodeMirror.on(i,"blur",function(){--a,setTimeout(function(){0>=a&&r()},200)}),CodeMirror.on(i,"focus",function(){++a})})}(),function(){function e(e){return"string"==typeof e?{token:function(t){return t.match(e)?"searching":(t.next(),void(t.skipTo(e.charAt(0))||t.skipToEnd()))}}:{token:function(t){if(t.match(e))return"searching";for(;!t.eol()&&(t.next(),!t.match(e,!1)););}}}function t(){this.overlay=this.posFrom=this.posTo=this.query=null}function o(e,t,o){return e.getSearchCursor(t,o,"string"==typeof t&&t==t.toLowerCase())}function n(e,t,o,n){e.openDialog?e.openDialog(t,n):n(prompt(o,""))}function r(e,t,o,n){e.openConfirm?e.openConfirm(t,n):confirm(o)&&n[0]()}function i(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);return t?RegExp(t[1],-1==t[2].indexOf("i")?"":"i"):e}function c(o,r){var c=o._searchState||(o._searchState=new t);return c.query?s(o,r):void n(o,u,"Search for:",function(t){o.operation(function(){t&&!c.query&&(c.query=i(t),o.removeOverlay(c.overlay),c.overlay=e(t),o.addOverlay(c.overlay),c.posFrom=c.posTo=o.getCursor(),s(o,r))})})}function s(e,n){e.operation(function(){var r=e._searchState||(e._searchState=new t),i=o(e,r.query,n?r.posFrom:r.posTo);(i.find(n)||(i=o(e,r.query,n?CodeMirror.Pos(e.lastLine()):CodeMirror.Pos(e.firstLine(),0)),i.find(n)))&&(e.setSelection(i.from(),i.to()),r.posFrom=i.from(),r.posTo=i.to())})}function f(e){e.operation(function(){var o=e._searchState||(e._searchState=new t);o.query&&(o.query=null,e.removeOverlay(o.overlay))})}function a(e,t){n(e,l,"Replace:",function(c){c&&(c=i(c),n(e,h,"Replace with:",function(n){if(t)e.operation(function(){for(var t,r=o(e,c);r.findNext();)"string"!=typeof c?(t=e.getRange(r.from(),r.to()).match(c),r.replace(n.replace(/\$(\d)/,function(e,o){return t[o]}))):r.replace(n)});else{f(e);var i=o(e,c,e.getCursor()),s=function(){var t,n=i.from();((t=i.findNext())||(i=o(e,c),(t=i.findNext())&&(!n||i.from().line!=n.line||i.from().ch!=n.ch)))&&(e.setSelection(i.from(),i.to()),r(e,p,"Replace?",[function(){a(t)},s]))},a=function(e){i.replace("string"==typeof c?n:n.replace(/\$(\d)/,function(t,o){return e[o]})),s()};s()}}))})}var u='Search: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',l='Replace: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',h='With: <input type="text" style="width: 10em"/>',p="Replace? <button>Yes</button> <button>No</button> <button>Stop</button>";CodeMirror.commands.find=function(e){f(e),c(e)},CodeMirror.commands.findNext=c,CodeMirror.commands.findPrev=function(e){c(e,!0)},CodeMirror.commands.clearSearch=f,CodeMirror.commands.replace=a,CodeMirror.commands.replaceAll=function(e){a(e,!0)}}(),function(){function e(e,o,n,r){if(this.atOccurrence=!1,this.cm=e,null==r&&"string"==typeof o&&(r=!1),n=n?e.clipPos(n):t(0,0),this.pos={from:n,to:n},"string"!=typeof o)o.global||(o=RegExp(o.source,o.ignoreCase?"ig":"g")),this.matches=function(n,r){var i;if(n){o.lastIndex=0;for(var c=e.getLine(r.line).slice(0,r.ch),s=o.exec(c),f=0;s&&(f+=s.index+1,c=c.slice(f),o.lastIndex=0,i=o.exec(c));)s=i;f--}else o.lastIndex=r.ch,c=e.getLine(r.line),f=(s=o.exec(c))&&s.index;if(s&&s[0])return{from:t(r.line,f),to:t(r.line,f+s[0].length),match:s}};else{r&&(o=o.toLowerCase());var i=r?function(e){return e.toLowerCase()}:function(e){return e},c=o.split("\n");this.matches=1==c.length?o.length?function(n,r){var c,s=i(e.getLine(r.line)),f=o.length;if(n?r.ch>=f&&-1!=(c=s.lastIndexOf(o,r.ch-f)):-1!=(c=s.indexOf(o,r.ch)))return{from:t(r.line,c),to:t(r.line,c+f)}}:function(){}:function(o,n){var r,s,f,a=n.line,u=o?c.length-1:0,l=c[u],h=i(e.getLine(a)),p=o?h.indexOf(l)+l.length:h.lastIndexOf(l);if(!(o?p>=n.ch||p!=l.length:p<=n.ch||p!=h.length-l.length))for(;!(o?!a:a==e.lineCount()-1);){if(h=i(e.getLine(a+=o?-1:1)),l=c[o?--u:++u],!(0<u&&u<c.length-1))return r=o?h.lastIndexOf(l):h.indexOf(l)+l.length,(o?r!=h.length-l.length:r!=l.length)?void 0:(s=t(n.line,p),f=t(a,r),{from:o?f:s,to:o?s:f});if(h!=l)break}}}}var t=CodeMirror.Pos;e.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function o(e){return e=t(e,0),r.pos={from:e,to:e},r.atOccurrence=!1,!1}for(var n,r=this,i=this.cm.clipPos(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,i))return this.pos.from&&this.pos.to||console.log(this.matches,this.pos),this.atOccurrence=!0,this.pos.match||!0;if(e){if(!i.line)return o(0);i=t(i.line-1,this.cm.getLine(i.line-1).length)}else{if(n=this.cm.lineCount(),i.line==n-1)return o(n);i=t(i.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(e){this.atOccurrence&&(e=CodeMirror.splitLines(e),this.cm.replaceRange(e,this.pos.from,this.pos.to),this.pos.to=t(this.pos.from.line+e.length-1,e[e.length-1].length+(1==e.length?this.pos.from.ch:0)))}},CodeMirror.defineExtension("getSearchCursor",function(t,o,n){return new e(this,t,o,n)})}();